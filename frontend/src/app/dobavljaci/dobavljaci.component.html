<app-charts *ngIf='!showMe'></app-charts>
<app-grades *ngIf='showMe && dobavljac' [dobavljac]='dobavljac' (showMeChanged)="showMeChangedHandler($event)"
  (dobavljacChanged)="dobavljacChangedHandler($event)"></app-grades>
<div class='card'>
  <div class='table-responsive'>
    <table class='table' *ngIf='dobavljaci && dobavljaci.length'>
      <thead>
        <tr>
          <th>#</th>
          <th>Firma</th>
          <th>Telefon</th>
          <th>Lokacija</th>
          <th>Početak ugovora</th>
          <th>Kraj ugovora</th>
          <th>Ocjena</th>
          <th></th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor='let dobavljac of dobavljaci'>
          <td>{{dobavljac.id}}</td>
          <td>
            {{dobavljac.nazivFirme}}
          </td>
          <td>{{ dobavljac.telefon }}</td>
          <td>{{ dobavljac.lokacija }}</td>
          <td>{{ dobavljac.pocetakUgovora }}</td>
          <td>{{ dobavljac.krajUgovora }}</td>
          <td>
            <app-stars [rating]='dobavljac.ocjena' (click)="handleStarsClick(dobavljac)"></app-stars>
          </td>
          <td> <button class='btn btn-primary' (click)="openModal(template, dobavljac)">Produži ugovor</button></td>
          <td><button class='btn btn-danger' (click)="openModal(confirm, dobavljac)">Poništi ugovor</button></td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<ng-template #confirm>
  <div class="modal-header">
    <h4 class="modal-title">Jeste li sigurni?</h4>
    <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide()">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <p>Jeste li sigurni da želite nastaviti?</p>
    <button  class="btn btn-success mr-3" (click)="onCancelContract()">Da</button>
    <button class="btn btn-danger" (click)="hideModal()">Ne</button>
  </div>
</ng-template>


<ng-template #template>
  <div class="modal-header">
    <h4 class="modal-title pull-left">Produži ugovor</h4>
    <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide()">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <p>{{modalDobavljac.nazivFirme}}</p>
    <p> {{modalDobavljac.lokacija}} </p>
    <form [formGroup]="dobavljacForma">
      <div class="form-group">
        <label>Vremenski raspon ugovora: </label>
        <input type="text" placeholder="Pocetak i kraj ugovora" bsDaterangepicker [bsConfig]="dpConfig"
          (bsValueChange)="onValueChange($event)" formControlName="rasponUgovora"  />
        <div *ngIf="submitted && f.rasponUgovora.errors" class="invalid-feedback">
          <div *ngIf="f.rasponUgovora.errors.required">Pocetak ugovora mora biti naveden</div>
        </div>
      </div>
      <button class="btn-success" (click)="onAddContract(modalDobavljac)">Potvrdi
      </button>
    </form>
  </div>
</ng-template>